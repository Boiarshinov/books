---
title: "Принципы юнит-тестирования"
tags:
  - programming
  - testing
draft: false
finishDate: 2021-09-19
isbn: 978-5-4461-1683-6
---

# Принципы юнит-тестирования

## Полное наименование

Хориков Владимир. Принципы юнит-тестирования. - СПб.: Питер, 2021. - 320 с.: ил. - (Серия "Для профессионалов").

![обложка](../_resources/khorikov_unit_testing.jpg)

Главный инсайт - отличия в определении понятия "юнит-тест" в разных школах юнит-тестирования.
Лондонская школа считает, что юнит-тест - это тест на единицу кода (чаще всего метод).
Классическая школа, считает, что юнит-тест - это тест на единицу поведения.
Из-за этого рождаются отличия в размере тестов и в подходе к мокированию.
Теперь стало понятно почему некоторые коллеги считали юнит-тестами то, что я относил к компонентным или интеграционным тестам.

Автор выступает за то, чтобы тестировать не отдельные классы и методы, а целиком пользовательские сценарии.
При этом для облегчения тестирования он предлагает выделять доменную модель, которая ни от чего не зависит и потому при тестировании не требует мокирования.
Для передачи данных от доменной модели к слою контроллеров можно использовать доменные события.

Хоть книга и называется "Принципы юнит-тестирования", по сути она учит писать чистый и легко поддерживаемый код.
Ну и тесты на него.

Мне понравилась методология написания кода **CQS** - command query separation.
Это когда все методы должны являться либо командами, либо запросами.
Запросы нужны, чтобы извлечь данные.
В них может быть что-то передано (идентификаторы данных), но они никак не модифицируют состояние системы.
Команды же направлены на изменение состояния.
Они не должны возвращать никаких данных.
Если следовать такому подходу, то мокировать зависимости становится намного проще.
При мокировании вызов запросов проверять не нужно, а вызов команд - нужно.

Про область покрытия интеграционными тестами:
> Проверьте как можно больше пограничных случаев бизнес-сценария юнит-тестами; используйте интеграционные тесты для покрытия одного позитивного пути, а также всех граничных случаев, которые не покрываются юнит-тестами.


## Критика

Автор в начале книги пишет, что он весь такой академический и сейчас будет строить все свои выводы как доказательства теорем, но в итоге многие рекомендации основаны на мнении и на чуйке.

